<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">

    <title>Auth</title>
    <script>

        const login_url = "http://localhost:3000/check_login";

        function queryLoginResult(request) {
            function reqListenerResult() {
                let data = JSON.parse(this.responseText);
                if (data.status == 'ok') {
                    window.location.href = data.redirect;
                } else {
                    let error_container = document.getElementById("error-container");
                    error_container.innerHTML = data.status;
                }
            }

            let oReq = new XMLHttpRequest();
            oReq.addEventListener('load', reqListenerResult);
            oReq.open("POST", request);
            oReq.setRequestHeader('Content-Type', 'application/json');
            oReq.send(JSON.stringify({ login : document.getElementById("login").value, password: document.getElementById("password").value }));
        }

        function goToRegister() {
            window.location.href = '/register';
        }

    </script>
</head>
<body style="background-color: rgb(64 99 111);">
    <div id="form-container" style="width: fit-content; height: fit-content; margin: auto;">
            <label for="login">Login:</label>
            <br>
            <input type="text" id="login" name="login" placeholder="" required>
            <br>
            <br>
            
            <label for="password">Password:</label>
            <br>
            <input type="password" id="password" name="password" placeholder="" required>
            <br>
            <br>

            <div id="button-container" style="text-align: center;">
                <button onclick="queryLoginResult(login_url)">
                    Log in
                </button>
                <br>
                <br>
            </div>
        <div style="text-align: center">
            <button id="regbutton" onclick="goToRegister()">
                Register
            </button>
        </div>
        <div id="error-container" style="color: rgb(201,89,106)">
        </div>
    </div>
</body>
</html>